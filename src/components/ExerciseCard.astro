---
const {
	id,
	sectionId,
	name,
	image,
	sets,
	reps,
	rest,
	restSeconds,
	cues = [],
	easyVariant,
	hardVariant,
	order,
} = Astro.props;
---

<article
	class="exercise-card group overflow-hidden rounded-2xl border border-slate-700/40 bg-slate-900/70 shadow-card transition"
	data-exercise-id={id}
	data-section-id={sectionId}
	data-rest={restSeconds}
>
	<div class="relative aspect-video overflow-hidden">
		<img src={image} alt={`Ejercicio: ${name}`} loading="lazy" class="h-full w-full object-cover" />
		{order && (
			<span
				class="absolute right-3 top-3 rounded-full border border-slate-700/60 bg-slate-900/80 px-3 py-1 text-xs font-semibold tracking-[0.15em] text-amber-300"
				data-exercise-order
			>
				#{order}
			</span>
		)}
	</div>
	<div class="flex flex-col gap-4 p-6">
		<div class="flex flex-wrap items-center justify-between gap-3">
			<h3 class="text-lg font-semibold text-slate-50">{name}</h3>
			<label class="inline-flex items-center gap-2 text-sm text-slate-300">
				<input
					type="checkbox"
					data-done-checkbox
					class="h-4 w-4 rounded border-slate-500 text-amber-400 focus:ring-amber-300"
				/>
				<span>Hecho</span>
			</label>
		</div>
		<dl class="grid gap-3 md:grid-cols-3">
			<div class="rounded-xl border border-slate-700/40 bg-slate-950/60 px-3 py-2">
				<dt class="text-[0.65rem] uppercase tracking-[0.2em] text-slate-400">Series</dt>
				<dd class="mt-1 text-sm font-semibold text-slate-100">{sets}</dd>
			</div>
			<div class="rounded-xl border border-slate-700/40 bg-slate-950/60 px-3 py-2">
				<dt class="text-[0.65rem] uppercase tracking-[0.2em] text-slate-400">Reps/Tiempo</dt>
				<dd class="mt-1 text-sm font-semibold text-slate-100">{reps}</dd>
			</div>
			<div class="rounded-xl border border-slate-700/40 bg-slate-950/60 px-3 py-2">
				<dt class="text-[0.65rem] uppercase tracking-[0.2em] text-slate-400">Descanso</dt>
				<dd class="mt-1 text-sm font-semibold text-slate-100">{rest}</dd>
			</div>
		</dl>
		<div class="exercise-card__timer flex flex-col gap-3 rounded-xl border border-slate-700/40 bg-slate-950/70 p-4" data-timer>
			<div class="flex items-center justify-between gap-3">
				<p class="text-sm text-slate-400">Descanso</p>
				<div class="text-sm font-semibold tracking-[0.3em] text-slate-100" data-timer-display>00:00</div>
			</div>
			<div class="grid grid-cols-4 gap-2">
				<button type="button" data-rest-option="20" class="rest-button">20s</button>
				<button type="button" data-rest-option="45" class="rest-button">45s</button>
				<button type="button" data-rest-option="60" class="rest-button">60s</button>
				<button type="button" data-rest-option="90" class="rest-button">90s</button>
			</div>
			<div class="grid grid-cols-2 gap-2">
				<button type="button" data-action="start" class="action-primary">Iniciar descanso</button>
				<button type="button" data-action="toggle" class="action-secondary" disabled>Pausar</button>
				<button type="button" data-action="reset" class="action-secondary" disabled>Reset</button>
				<button type="button" data-action="next" class="action-secondary">Siguiente</button>
			</div>
			<div class="min-h-[1.1rem] text-xs text-slate-400" data-timer-status aria-live="polite"></div>
			<button type="button" data-action="mark-done" hidden class="action-success">
				Marcar como hecho
			</button>
		</div>
		{cues?.length > 0 && (
			<div class="rounded-xl border border-slate-700/30 bg-slate-950/50 p-4">
				<h4 class="text-sm font-semibold text-slate-100">Pistas tecnicas</h4>
				<ul class="mt-2 grid gap-1 text-sm text-slate-300">
					{cues.map((cue) => (
						<li>{cue}</li>
					))}
				</ul>
			</div>
		)}
		{(easyVariant || hardVariant) && (
			<div class="rounded-xl border border-slate-700/30 bg-slate-950/50 p-4">
				<h4 class="text-sm font-semibold text-slate-100">Variantes</h4>
				<ul class="mt-2 grid gap-1 text-sm text-slate-300">
					{easyVariant && (
						<li>
							<span class="font-semibold text-amber-300">Facil:</span> {easyVariant}
						</li>
					)}
					{hardVariant && (
						<li>
							<span class="font-semibold text-amber-300">Dificil:</span> {hardVariant}
						</li>
					)}
				</ul>
			</div>
		)}
	</div>
</article>
